<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AR.js dengan Posisi Terkunci dan Marker Hiro</title>

  <!-- A-Frame Library -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>

  <!-- AR.js Library -->
  <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js/aframe/build/aframe-ar.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      touch-action: none;
    }

    a-scene {
      width: 100%;
      height: 100%;
    }

    a-camera {
      z-index: 1;
      position: fixed;
      height: 100%;
      width: 100%;
      pointer-events: none;
    }
  </style>
</head>
<body style="margin: 0; overflow: hidden;">
  <a-scene embedded arjs="sourceType: webcam; markerAreaEnabled: false; debugUIEnabled: true; trackingMethod: best; max-camera-orientation: 0.5;">

    <!-- Marker Hiro untuk menampilkan objek 3D -->
    <a-marker preset="hiro" id="marker1">
      <a-entity id="modelEntity1" position="0 0.5 0" scale="0.5 0.5 0.5">
        <a-gltf-model src="Model4.glb"></a-gltf-model>
      </a-entity>
    </a-marker>

    <!-- Kamera untuk AR.js -->
    <a-camera position="0 0 0" fov="80" near="0.1" far="1000" rotation="0 0 0"></a-camera>

  </a-scene>

  <script>
    const modelEntity1 = document.getElementById('modelEntity1');
    const marker1 = document.getElementById('marker1');
    let savedPosition = null; // Variabel untuk menyimpan posisi objek ketika marker terdeteksi

    // Fungsi untuk menyimpan posisi objek ketika marker ditemukan
    function savePosition() {
      if (savedPosition === null) {
        savedPosition = modelEntity1.object3D.position.clone(); // Simpan posisi dunia saat marker ditemukan
      }
    }

    // Fungsi untuk memastikan objek tetap pada posisi yang tersimpan
    function keepModelAtSavedPosition() {
      if (savedPosition !== null) {
        modelEntity1.object3D.position.copy(savedPosition); // Tetapkan posisi yang tersimpan ke objek
      }
    }

    // Ketika marker ditemukan, simpan posisi objek
    marker1.addEventListener('markerFound', function() {
      savePosition();
    });

    // Ketika marker hilang, pastikan objek tetap pada posisi yang tersimpan
    marker1.addEventListener('markerLost', function() {
      // Jangan hapus objek, tetap pada posisi yang disimpan
      keepModelAtSavedPosition();
    });

    // Animasi untuk memastikan objek tetap berada di posisi yang tersimpan meskipun marker hilang
    function animate() {
      if (savedPosition !== null) {
        keepModelAtSavedPosition();
      }
      requestAnimationFrame(animate);
    }

    animate(); // Mulai animasi
  </script>
</body>
</html>
